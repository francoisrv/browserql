import { Meta, Story, Canvas, ArgsTable } from '@storybook/addon-docs/blocks'
import { BrowserqlProvider, BrowserqlQuery } from '../../packages/react/src'
import GraphiQL from '../../packages/graphiql/src'
import gql from 'graphql-tag'

<Meta
  title="react/GraphiQL"
  component={GraphiQL}
  argTypes={{
    schema: {
      name: 'GraphQL schema',
      description: 'A valid GraphQL schema',
      control: 'text',
    },
  }}
/>

export const Template = (args) => (
  <BrowserqlProvider
    schema={gql`
      extend type Query {
        sayHello: String
      }
    `}
    queries={{
      sayHello() {
        return 'Browserql Provider is working!'
      },
    }}
    extensions={[{ schema: args.schema }]}
    renderError={args.renderError}
  >
    <BrowserqlQuery
      query={gql`
        query {
          sayHello
        }
      `}
      renderError="ERROR"
      renderLoading={<div>LOADING</div>}
      render={(res) => <b>{res}</b>}
    />
  </BrowserqlProvider>
)

# GraphiQL

Use GraphiQL with browserql

## Usage

```jsx
import React from 'react'
import { useQuery } from '@apollo/client'
import gql from 'graphql-tag'

export default function App() {
  const { data, loading, error } = useQuery(
    gql`
    query Q($id: ID!) {
      getUserById(id: $id): User
    }
  `,
    { id: '1234' }
  )
  if (error) {
    return <div>{error.message}</div>
  }
  if (loading) {
    return <div>Loading</div>
  }
  const { getUserById } = data
  return <div>{getUserById.name}</div>
}
```

[Sandbox code](https://codesandbox.io/s/browserql-react-provider-znovb)

<Canvas withToolbar className="code-in-ss">
  <Story
    name="Example"
    args={{
      schema: `
        type Foo {
          id: ID!
        }
      `,
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

## Props

<ArgsTable of={GraphiQL} />
